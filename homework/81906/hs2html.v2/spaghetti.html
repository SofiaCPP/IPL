<!doctype><html><head>    <title>spaghetti.hs</title>    <script>    function toggle(btn){      let span = btn.nextSibling;      if(span.style.display == "none")        span.style.display = "inline";        else          span.style.display = "none";    }    </script>    <style>        body {            background-color: #2e3436;            color: white;        }        button {            border-radius: 0px;            border-width: 0px;            height: 15px;            width: 15px;	 }        .keyword {            color: #b4fa70;        }        .number {            color: blue;        }        .string {            color: #e9b96e;        }        .operator {            font-style: bold;            color: #fcaf3e;        }        .identifier {	     color: white;        }        .classname {	     color: lightblue;        }        .comment {	     color: #6ec619;        }    </style></head><body>    <pre class="code">
<span class="keyword">import</span> <span class="classname">Prelude</span>
<span class="keyword">import</span> <span class="classname">Control</span><span class="operator">.</span><span class="classname">Monad</span>
<span class="keyword">import</span> <span class="classname">Data</span><span class="operator">.</span><span class="classname">List</span><span class="operator">.</span><span class="classname">Split</span>

<span class="keyword">data</span> <span class="classname">File</span> <span class="operator">=</span> <span class="classname">File</span> Unrecognized character: {
<span class="identifier">fileName</span><span class="operator">::</span><span class="classname">String</span>, <span class="identifier">content</span><span class="operator">::</span><span class="classname">String</span>Unrecognized character: }
 <span class="keyword">deriving</span> (<span class="classname">Eq</span>, <span class="classname">Show</span>)
<span class="keyword">data</span> <span class="classname">Directory</span> <span class="operator">=</span> <span class="classname">Directory</span> Unrecognized character: {
<span class="identifier">dirName</span><span class="operator">::</span><span class="classname">String</span>, <span class="identifier">subDirectories</span>::[<span class="classname">Directory</span>], <span class="identifier">files</span>::[<span class="classname">File</span>]Unrecognized character: }
  <span class="keyword">deriving</span> (<span class="classname">Eq</span>, <span class="classname">Show</span>)

<span class="identifier">addDirectory</span> :: <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">addDirectory</span> (<span class="classname">Just</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span>)) <span class="identifier">name</span> <span class="operator">=</span> 
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">if</span> (<span class="identifier">getSubDirectory</span> <span class="identifier">name</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span>)) <span class="operator">=</span><span class="operator">=</span> <span class="classname">Nothing</span> <span class="keyword">then</span>
        <span class="classname">Directory</span> <span class="identifier">dirName</span> (<span class="identifier">dirs</span> <span class="operator">+</span><span class="operator">+</span> [(<span class="classname">Directory</span> <span class="identifier">name</span> [] [])]) <span class="identifier">files</span>
    <span class="keyword">else</span>
        (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span>)</span>

<span class="identifier">hasFileHelper</span> (<span class="classname">File</span> <span class="identifier">fileName</span> <span class="identifier">content</span>) <span class="identifier">targetName</span> <span class="operator">=</span> 
    <span class="identifier">fileName</span> <span class="operator">=</span><span class="operator">=</span> <span class="identifier">targetName</span>

<span class="identifier">hasFile</span> :: [<span class="classname">File</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">File</span>
<span class="identifier">hasFile</span> [] <span class="identifier">_</span> <span class="operator">=</span> <span class="classname">Nothing</span>
<span class="identifier">hasFile</span> <span class="identifier">fileList</span> <span class="identifier">fileName</span> <span class="operator">=</span> 
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">if</span> <span class="identifier">hasFileHelper</span> (<span class="identifier">head</span> <span class="identifier">fileList</span>) <span class="identifier">fileName</span> <span class="keyword">then</span>
        (<span class="classname">Just</span> (<span class="identifier">head</span> <span class="identifier">fileList</span>))
    <span class="keyword">else</span> 
        <span class="identifier">hasFile</span> (<span class="identifier">tail</span> <span class="identifier">fileList</span>) <span class="identifier">fileName</span> </span>
    

<span class="identifier">addFile</span> :: <span class="classname">File</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">addFile</span> <span class="identifier">file</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span>) <span class="operator">=</span> 
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">if</span> (<span class="identifier">hasFile</span> <span class="identifier">files</span> <span class="identifier">name</span>) <span class="operator">=</span><span class="operator">=</span> <span class="classname">Nothing</span> <span class="keyword">then</span>
        <span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> (<span class="identifier">files</span> <span class="operator">+</span><span class="operator">+</span> [<span class="identifier">file</span>])
    <span class="keyword">else</span>
        <span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span></span>
    <span class="keyword">where</span> <span class="identifier">name</span> <span class="operator">=</span> (<span class="identifier">fileName</span> <span class="identifier">file</span>)

<span class="identifier">splitPath</span> :: <span class="classname">String</span> <span class="operator">-></span> [<span class="classname">String</span>]
<span class="identifier">splitPath</span> <span class="identifier">path</span> 
    <span class="operator">|</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">0</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'/'</span> <span class="operator">=</span> <span class="string">"/"</span>:(<span class="identifier">splitOn</span> <span class="string">"/"</span> (<span class="identifier">tail</span> <span class="identifier">path</span>))
    <span class="operator">|</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">0</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'.'</span> <span class="operator">&</span><span class="operator">&</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">1</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'/'</span> <span class="operator">=</span> (<span class="identifier">splitOn</span> <span class="string">"/"</span> (<span class="identifier">drop</span> <span class="number">2</span> <span class="identifier">path</span>))
    <span class="operator">|</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">0</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'.'</span> <span class="operator">&</span><span class="operator">&</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">1</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'.'</span> <span class="operator">&</span><span class="operator">&</span> <span class="identifier">path</span> <span class="operator">!</span><span class="operator">!</span> <span class="number">2</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">'/'</span> <span class="operator">=</span> <span class="string">"/"</span>:(<span class="identifier">take</span> ((<span class="identifier">length</span> (<span class="identifier">splitOn</span> <span class="string">"/"</span> (<span class="identifier">drop</span> <span class="number">3</span> <span class="identifier">path</span>))) <span class="operator">-</span> <span class="number">1</span>) (<span class="identifier">splitOn</span> <span class="string">"/"</span> (<span class="identifier">drop</span> <span class="number">3</span> <span class="identifier">path</span>)))
    <span class="operator">|</span> <span class="identifier">otherwise</span> <span class="operator">=</span> <span class="identifier">splitOn</span> <span class="string">"/"</span> <span class="identifier">path</span>


<span class="identifier">splitInput</span> :: <span class="classname">String</span> <span class="operator">-></span> [<span class="classname">String</span>]
<span class="identifier">splitInput</span> <span class="identifier">input</span> <span class="operator">=</span> <span class="identifier">splitOn</span> <span class="string">" "</span> <span class="identifier">input</span>

<span class="identifier">getSubDirectoryHelper</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Bool</span>
<span class="identifier">getSubDirectoryHelper</span> <span class="identifier">name</span> <span class="identifier">directory</span> <span class="operator">=</span> <span class="identifier">name</span> <span class="operator">=</span><span class="operator">=</span> <span class="identifier">directoryName</span>
   <span class="keyword">where</span> <span class="identifier">directoryName</span> <span class="operator">=</span> <span class="identifier">dirName</span> <span class="identifier">directory</span>

<span class="identifier">getSubDirectory</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span>
<span class="identifier">getSubDirectory</span> <span class="identifier">name</span> (<span class="classname">Directory</span> <span class="identifier">dirname</span> <span class="identifier">dirs</span> <span class="identifier">files</span>) 
    <span class="operator">|</span> <span class="identifier">name</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">""</span> <span class="operator">=</span> <span class="classname">Just</span> (<span class="classname">Directory</span> <span class="identifier">dirname</span> <span class="identifier">dirs</span> <span class="identifier">files</span>)
    <span class="operator">|</span> <span class="identifier">null</span> <span class="identifier">dirs</span> <span class="operator">=</span> <span class="classname">Nothing</span>
    <span class="operator">|</span> <span class="identifier">getSubDirectoryHelper</span> <span class="identifier">name</span> (<span class="identifier">head</span> <span class="identifier">dirs</span>) <span class="operator">=</span> <span class="classname">Just</span> (<span class="identifier">head</span> <span class="identifier">dirs</span>)
    <span class="operator">|</span> <span class="identifier">otherwise</span> <span class="operator">=</span> <span class="identifier">getSubDirectory</span> <span class="identifier">name</span> (<span class="classname">Directory</span> <span class="identifier">dirname</span> (<span class="identifier">tail</span> <span class="identifier">dirs</span>) <span class="identifier">files</span>)


<span class="identifier">getDirectory</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span>
<span class="identifier">getDirectory</span> <span class="identifier">_</span> <span class="classname">Nothing</span> <span class="operator">=</span> <span class="classname">Nothing</span>
<span class="identifier">getDirectory</span> [] (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="operator">=</span> <span class="classname">Just</span> <span class="identifier">mainDirectory</span>
<span class="identifier">getDirectory</span> <span class="identifier">pathInList</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="operator">=</span> 
    <span class="identifier">getDirectory</span> (<span class="identifier">tail</span> <span class="identifier">pathInList</span>) (<span class="identifier">getSubDirectory</span> (<span class="identifier">head</span> <span class="identifier">pathInList</span>) <span class="identifier">mainDirectory</span>)

<span class="identifier">cd</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span>
<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="operator">=</span>
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">let</span> <span class="identifier">k</span> <span class="operator">=</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>) <span class="keyword">in</span>
        <span class="keyword">if</span> (<span class="identifier">head</span> <span class="identifier">k</span>) <span class="operator">=</span><span class="operator">=</span> <span class="string">"/"</span> <span class="keyword">then</span> 
            <span class="identifier">getDirectory</span> (<span class="identifier">tail</span> <span class="identifier">k</span>) (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>)
        <span class="keyword">else</span>
            <span class="identifier">getDirectory</span> <span class="identifier">k</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) </span>


<span class="identifier">findFileHelper</span> :: <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">File</span>
<span class="identifier">findFileHelper</span> (<span class="classname">Just</span> (<span class="classname">Directory</span> <span class="identifier">_</span> <span class="identifier">_</span> <span class="identifier">files</span>)) <span class="identifier">fileName</span> <span class="operator">=</span> (<span class="identifier">hasFile</span> <span class="identifier">files</span> <span class="identifier">fileName</span>)

<span class="identifier">findFile</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">File</span>
<span class="identifier">findFile</span> <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="operator">=</span>
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">let</span> <span class="identifier">k</span> <span class="operator">=</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>) <span class="keyword">in</span> 
        <span class="keyword">if</span> (<span class="identifier">head</span> <span class="identifier">k</span>) <span class="operator">=</span><span class="operator">=</span> <span class="string">"/"</span> <span class="keyword">then</span> 
            (<span class="identifier">findFileHelper</span> (<span class="identifier">getDirectory</span> (<span class="identifier">take</span> ((<span class="identifier">length</span> <span class="identifier">k</span>) <span class="operator">-</span> <span class="number">2</span>) (<span class="identifier">tail</span> <span class="identifier">k</span>)) (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>)) (<span class="identifier">head</span> (<span class="identifier">reverse</span> <span class="identifier">k</span>)))
        <span class="keyword">else</span>
            (<span class="identifier">findFileHelper</span> (<span class="identifier">getDirectory</span> (<span class="identifier">take</span> ((<span class="identifier">length</span> <span class="identifier">k</span>) <span class="operator">-</span> <span class="number">1</span>) (<span class="identifier">tail</span> <span class="identifier">k</span> )) (<span class="classname">Just</span> <span class="identifier">currDirectory</span>)) (<span class="identifier">head</span> (<span class="identifier">reverse</span> <span class="identifier">k</span>)))</span>

<span class="identifier">concatContent</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">File</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">concatContent</span> <span class="identifier">result</span> (<span class="classname">Just</span> <span class="identifier">file</span>) <span class="operator">=</span> (<span class="identifier">result</span> <span class="operator">+</span><span class="operator">+</span> (<span class="identifier">content</span> <span class="identifier">file</span>))

<span class="identifier">inputFileContent</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">IO</span> <span class="classname">String</span>
<span class="identifier">inputFileContent</span> <span class="identifier">result</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="identifier">input</span> <span class="operator"><-</span> <span class="identifier">getLine</span>
    <span class="keyword">if</span> <span class="identifier">input</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">"."</span> <span class="keyword">then</span> 
        <span class="identifier">return</span> <span class="identifier">result</span>
    <span class="keyword">else</span> 
        <span class="identifier">inputFileContent</span> (<span class="identifier">result</span> <span class="operator">+</span><span class="operator">+</span> <span class="identifier">input</span> <span class="operator">+</span><span class="operator">+</span> <span class="string">"\n"</span>)</span>

<span class="identifier">catGenCurrDir</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">catGenCurrDir</span> <span class="identifier">fileName</span> <span class="identifier">fileContent</span> <span class="identifier">currDirectory</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">if</span> (<span class="identifier">hasFile</span> (<span class="identifier">files</span> <span class="identifier">currDirectory</span>) <span class="identifier">fileName</span>) <span class="operator">/=</span> <span class="classname">Nothing</span> <span class="keyword">then</span>
        (<span class="identifier">addFile</span> (<span class="classname">File</span> <span class="identifier">fileName</span> <span class="identifier">fileContent</span>) (<span class="identifier">rm</span> <span class="identifier">fileName</span> <span class="identifier">currDirectory</span>))
    <span class="keyword">else</span> 
        (<span class="identifier">addFile</span> (<span class="classname">File</span> <span class="identifier">fileName</span> <span class="identifier">fileContent</span>) <span class="identifier">currDirectory</span>)</span>

<span class="identifier">catInputFileHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">catInputFileHelper</span> <span class="identifier">paths</span> <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="identifier">result</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="keyword">let</span> <span class="identifier">fileName</span> <span class="operator">=</span> (<span class="identifier">head</span> <span class="identifier">paths</span>)<span class="operator">-</span><span class="operator">-</span> (<span class="identifier">head</span> (<span class="identifier">reverse</span> (<span class="identifier">splitPath</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">paths</span>)))))
    <span class="identifier">fileContent</span> <span class="operator"><-</span> (<span class="identifier">inputFileContent</span> <span class="string">""</span>)
    <span class="keyword">let</span> <span class="identifier">currDir</span> <span class="operator">=</span> <span class="identifier">catGenCurrDir</span> <span class="identifier">fileName</span> <span class="identifier">fileContent</span> <span class="identifier">currDirectory</span>
    <span class="identifier">putStrLn</span> (<span class="identifier">show</span> <span class="identifier">currDir</span>)
    <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">mainDir</span>) <span class="operator">=</span> (<span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) (<span class="identifier">splitPath</span> <span class="identifier">path</span>) <span class="identifier">currDir</span>)
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDir</span>) <span class="identifier">path</span> (<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">mainDir</span> <span class="identifier">mainDir</span>)</span>

<span class="identifier">catFileAssignHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">catFileAssignHelper</span> <span class="identifier">paths</span> <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="identifier">result</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="keyword">let</span> <span class="identifier">fileName</span> <span class="operator">=</span> (<span class="identifier">head</span> <span class="identifier">paths</span>)<span class="operator">-</span><span class="operator">-</span> (<span class="identifier">head</span> (<span class="identifier">reverse</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>)))
    <span class="keyword">let</span> <span class="identifier">currDir</span> <span class="operator">=</span> <span class="identifier">catGenCurrDir</span> <span class="identifier">fileName</span> <span class="identifier">result</span> <span class="identifier">currDirectory</span><span class="operator">-</span><span class="operator">-</span> (<span class="identifier">addFile</span> (<span class="classname">File</span> <span class="identifier">fileName</span> <span class="identifier">result</span>) (<span class="identifier">rm</span> <span class="identifier">fileName</span> <span class="identifier">currDirectory</span>))
    <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">mainDir</span>) <span class="operator">=</span> (<span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) (<span class="identifier">splitPath</span> <span class="identifier">path</span>) <span class="identifier">currDir</span>)
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDir</span>) <span class="identifier">path</span> (<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">mainDir</span> <span class="identifier">mainDir</span>)</span>

<span class="identifier">cat</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">cat</span> <span class="identifier">paths</span> <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="identifier">result</span>
    <span class="operator">|</span> ((<span class="identifier">length</span> <span class="identifier">paths</span>) <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span>) <span class="operator">&</span><span class="operator">&</span> ((<span class="identifier">head</span> <span class="identifier">paths</span>) <span class="operator">/=</span> <span class="string">">"</span>) <span class="operator">&</span><span class="operator">&</span> (<span class="identifier">result</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">""</span>) <span class="operator">=</span> 
        <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">file</span>) <span class="operator">=</span> (<span class="identifier">findFile</span> (<span class="identifier">head</span> <span class="identifier">paths</span>) <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span>) <span class="keyword">in</span> <span class="identifier">putStrLn</span> (<span class="identifier">content</span> <span class="identifier">file</span>)
    <span class="operator">|</span> (<span class="identifier">head</span> <span class="identifier">paths</span>) <span class="operator">=</span><span class="operator">=</span> <span class="string">">"</span> <span class="operator">&</span><span class="operator">&</span> <span class="identifier">result</span> <span class="operator">/=</span> <span class="string">""</span> <span class="operator">=</span> 
        <span class="identifier">catFileAssignHelper</span> (<span class="identifier">tail</span> <span class="identifier">paths</span>) <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="identifier">result</span>
    <span class="operator">|</span> (<span class="identifier">head</span> <span class="identifier">paths</span>) <span class="operator">=</span><span class="operator">=</span> <span class="string">">"</span> <span class="operator">&</span><span class="operator">&</span> <span class="identifier">result</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">""</span> <span class="operator">=</span> 
        <span class="identifier">catInputFileHelper</span> (<span class="identifier">tail</span> <span class="identifier">paths</span>) <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="identifier">result</span>
    <span class="operator">|</span> <span class="identifier">otherwise</span> <span class="operator">=</span> <span class="identifier">cat</span> (<span class="identifier">tail</span> <span class="identifier">paths</span>) <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> (<span class="identifier">concatContent</span> <span class="identifier">result</span> (<span class="identifier">findFile</span> (<span class="identifier">head</span> <span class="identifier">paths</span>) <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span>))

<span class="identifier">mkdir</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">mkdir</span> <span class="identifier">name</span> <span class="identifier">currDirectory</span> <span class="operator">=</span> <span class="identifier">addDirectory</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) <span class="identifier">name</span>

<span class="identifier">conCatDirs</span> :: [<span class="classname">Directory</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">conCatDirs</span> [] <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">result</span>
<span class="identifier">conCatDirs</span> <span class="identifier">dirs</span> <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">conCatDirs</span> (<span class="identifier">tail</span> <span class="identifier">dirs</span>) (<span class="identifier">result</span> <span class="operator">+</span><span class="operator">+</span> (<span class="identifier">dirName</span> (<span class="identifier">head</span> <span class="identifier">dirs</span>)) <span class="operator">+</span><span class="operator">+</span> <span class="string">" "</span>)

<span class="identifier">conCatFiles</span> :: [<span class="classname">File</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">conCatFiles</span> [] <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">result</span>
<span class="identifier">conCatFiles</span> <span class="identifier">files</span> <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">conCatFiles</span> (<span class="identifier">tail</span> <span class="identifier">files</span>) (<span class="identifier">result</span> <span class="operator">+</span><span class="operator">+</span> (<span class="identifier">fileName</span> (<span class="identifier">head</span> <span class="identifier">files</span>)) <span class="operator">+</span><span class="operator">+</span> <span class="string">" "</span>)

<span class="identifier">conCatStringListHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">conCatStringListHelper</span> [] <span class="identifier">_</span> <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">result</span>
<span class="identifier">conCatStringListHelper</span> <span class="identifier">stringList</span> <span class="identifier">separator</span> <span class="identifier">result</span> <span class="operator">=</span> <span class="identifier">conCatStringListHelper</span> (<span class="identifier">tail</span> <span class="identifier">stringList</span>) <span class="identifier">separator</span> (<span class="identifier">result</span> <span class="operator">+</span><span class="operator">+</span> <span class="identifier">separator</span> <span class="operator">+</span><span class="operator">+</span> (<span class="identifier">head</span> <span class="identifier">stringList</span>))

<span class="identifier">conCatStringList</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">conCatStringList</span> <span class="identifier">stringList</span> <span class="identifier">separator</span> <span class="operator">=</span> <span class="identifier">conCatStringListHelper</span> <span class="identifier">stringList</span> <span class="identifier">separator</span> <span class="string">""</span>


<span class="identifier">ls</span> :: <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">ls</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">files</span>) <span class="operator">=</span> 
    <span class="identifier">putStrLn</span> ((<span class="identifier">conCatDirs</span> <span class="identifier">dirs</span> <span class="string">""</span>) <span class="operator">+</span><span class="operator">+</span> (<span class="identifier">conCatFiles</span> <span class="identifier">files</span> <span class="string">""</span>) )

<span class="identifier">contentString</span> :: <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">contentString</span> <span class="identifier">directory</span>  <span class="operator">=</span> <span class="string">"/"</span>

<span class="identifier">touch</span> <span class="identifier">name</span> <span class="identifier">currDirectory</span> <span class="operator">=</span> <span class="identifier">addFile</span> (<span class="classname">File</span> <span class="identifier">name</span> <span class="string">""</span>) <span class="identifier">currDirectory</span>

<span class="identifier">rmDirHelper</span> :: <span class="classname">String</span> <span class="operator">-></span> [<span class="classname">Directory</span>] <span class="operator">-></span> [<span class="classname">Directory</span>]
<span class="identifier">rmDirHelper</span> <span class="identifier">dirname</span> <span class="identifier">dirs</span> 
    <span class="operator">|</span><span class="identifier">null</span> <span class="identifier">dirs</span> <span class="operator">=</span> []
    <span class="operator">|</span><span class="identifier">dirname</span> <span class="operator">=</span><span class="operator">=</span> (<span class="identifier">dirName</span> (<span class="identifier">head</span> <span class="identifier">dirs</span>)) <span class="operator">=</span> (<span class="identifier">tail</span> <span class="identifier">dirs</span>)
    <span class="operator">|</span><span class="identifier">otherwise</span> <span class="operator">=</span> <span class="identifier">rmDirHelper</span> <span class="identifier">dirname</span> (<span class="identifier">tail</span> <span class="identifier">dirs</span>)

<span class="identifier">rmdir</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">rmdir</span> <span class="identifier">dirName</span> (<span class="classname">Directory</span> <span class="identifier">name</span> <span class="identifier">dirs</span> <span class="identifier">files</span>) <span class="operator">=</span> 
    <span class="classname">Directory</span> <span class="identifier">name</span> (<span class="identifier">rmDirHelper</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span>) <span class="identifier">files</span>
  
<span class="identifier">rmFileHelper</span> :: <span class="classname">String</span> <span class="operator">-></span> [<span class="classname">File</span>] <span class="operator">-></span> [<span class="classname">File</span>]
<span class="identifier">rmFileHelper</span> <span class="identifier">filename</span> <span class="identifier">files</span> 
    <span class="operator">|</span><span class="identifier">null</span> <span class="identifier">files</span> <span class="operator">=</span> []
    <span class="operator">|</span><span class="identifier">filename</span> <span class="operator">=</span><span class="operator">=</span> (<span class="identifier">fileName</span> (<span class="identifier">head</span> <span class="identifier">files</span>)) <span class="operator">=</span> (<span class="identifier">tail</span> <span class="identifier">files</span>)
    <span class="operator">|</span><span class="identifier">otherwise</span> <span class="operator">=</span> <span class="identifier">rmFileHelper</span> <span class="identifier">filename</span> (<span class="identifier">tail</span> <span class="identifier">files</span>)

<span class="identifier">rm</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Directory</span>
<span class="identifier">rm</span> <span class="identifier">fileName</span> (<span class="classname">Directory</span> <span class="identifier">name</span> <span class="identifier">dirs</span> <span class="identifier">files</span>) <span class="operator">=</span> 
    <span class="classname">Directory</span> <span class="identifier">name</span> <span class="identifier">dirs</span> (<span class="identifier">rmFileHelper</span> <span class="identifier">fileName</span> <span class="identifier">files</span>) 

<span class="identifier">addDir</span> :: <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span>
<span class="identifier">addDir</span> <span class="identifier">_</span> <span class="classname">Nothing</span> <span class="operator">=</span> <span class="classname">Nothing</span>
<span class="identifier">addDir</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> <span class="identifier">dirs</span> <span class="identifier">file</span>) (<span class="classname">Just</span> <span class="identifier">newDirectory</span>) <span class="operator">=</span> 
    <span class="classname">Just</span> (<span class="classname">Directory</span> <span class="identifier">dirName</span> (<span class="identifier">dirs</span> <span class="operator">+</span><span class="operator">+</span> [<span class="identifier">newDirectory</span>]) <span class="identifier">file</span>)

<span class="identifier">changeDirectory</span> :: <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span>
<span class="identifier">changeDirectory</span> <span class="classname">Nothing</span> <span class="identifier">_</span> <span class="identifier">_</span> <span class="operator">=</span> <span class="classname">Nothing</span> 
<span class="identifier">changeDirectory</span> <span class="identifier">_</span> [] <span class="identifier">changedDirectory</span> <span class="operator">=</span> (<span class="classname">Just</span> <span class="identifier">changedDirectory</span>)
<span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">pathInList</span> <span class="identifier">changedDirectory</span> <span class="operator">=</span>
    <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">let</span> <span class="identifier">k</span> <span class="operator">=</span> <span class="identifier">changeDirectory</span> (<span class="identifier">cd</span> (<span class="identifier">head</span> <span class="identifier">pathInList</span>) <span class="identifier">mainDirectory</span> <span class="identifier">mainDirectory</span>) (<span class="identifier">tail</span> <span class="identifier">pathInList</span>) <span class="identifier">changedDirectory</span> <span class="keyword">in</span>
        <span class="keyword">if</span> (<span class="identifier">dirName</span> <span class="identifier">changedDirectory</span>) <span class="operator">=</span><span class="operator">=</span> <span class="string">"/"</span> <span class="keyword">then</span> 
            <span class="classname">Just</span> <span class="identifier">changedDirectory</span>
        <span class="keyword">else</span>
            <span class="identifier">addDir</span> (<span class="identifier">rmdir</span> (<span class="identifier">head</span> <span class="identifier">pathInList</span>) <span class="identifier">mainDirectory</span>) <span class="identifier">k</span> <span class="operator">-</span><span class="operator">-</span>  <span class="classname">Just</span> <span class="identifier">changedDirectory</span></span>

<span class="identifier">rmMainHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">rmMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="keyword">let</span> <span class="identifier">changedDirectory</span> <span class="operator">=</span> (<span class="identifier">rm</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>)) <span class="identifier">currDirectory</span>)
    <span class="keyword">let</span> <span class="identifier">pathList</span> <span class="operator">=</span> (<span class="identifier">tail</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>))
    <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">newMainDirectory</span>) <span class="operator">=</span> <span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">pathList</span> <span class="identifier">changedDirectory</span>
    <span class="keyword">let</span> <span class="identifier">newCurrDirectory</span> <span class="operator">=</span> (<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">newMainDirectory</span> <span class="identifier">mainDirectory</span>) 
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">newMainDirectory</span>) <span class="identifier">path</span> <span class="identifier">newCurrDirectory</span></span>
    
<span class="identifier">mkdirMainHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">mkdirMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="keyword">let</span> <span class="identifier">changedDirectory</span> <span class="operator">=</span> (<span class="identifier">mkdir</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>)) <span class="identifier">currDirectory</span>)
    <span class="keyword">let</span> <span class="identifier">pathList</span> <span class="operator">=</span> (<span class="identifier">tail</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>))
    <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">newMainDirectory</span>) <span class="operator">=</span> <span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">pathList</span> <span class="identifier">changedDirectory</span>
    <span class="keyword">let</span> <span class="identifier">newCurrDirectory</span> <span class="operator">=</span> (<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">newMainDirectory</span> <span class="identifier">mainDirectory</span>) 
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">newMainDirectory</span>) <span class="identifier">path</span> <span class="identifier">newCurrDirectory</span></span>

<span class="identifier">touchMainHelper</span> :: [<span class="classname">String</span>] <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">touchMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="keyword">let</span> <span class="identifier">changedDirectory</span> <span class="operator">=</span> (<span class="identifier">touch</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>)) <span class="identifier">currDirectory</span>)
    <span class="keyword">let</span> <span class="identifier">pathList</span> <span class="operator">=</span> (<span class="identifier">tail</span> (<span class="identifier">splitPath</span> <span class="identifier">path</span>))
    <span class="keyword">let</span> (<span class="classname">Just</span> <span class="identifier">newMainDirectory</span>) <span class="operator">=</span> <span class="identifier">changeDirectory</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">pathList</span> <span class="identifier">changedDirectory</span>
    <span class="keyword">let</span> <span class="identifier">newCurrDirectory</span> <span class="operator">=</span> (<span class="identifier">cd</span> <span class="identifier">path</span> <span class="identifier">newMainDirectory</span> <span class="identifier">mainDirectory</span>) 
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> <span class="identifier">newCurrDirectory</span></span>

<span class="identifier">buildPath</span> :: <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">String</span>
<span class="identifier">buildPath</span> <span class="identifier">path</span> <span class="identifier">next</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">if</span> <span class="identifier">path</span> <span class="operator">=</span><span class="operator">=</span> <span class="string">"/"</span> <span class="keyword">then</span>
        (<span class="identifier">path</span> <span class="operator">+</span><span class="operator">+</span> <span class="identifier">next</span>)
    <span class="keyword">else</span>
        (<span class="identifier">path</span> <span class="operator">+</span><span class="operator">+</span> <span class="string">"/"</span> <span class="operator">+</span><span class="operator">+</span> <span class="identifier">next</span>)</span>

<span class="identifier">directoryRecursion</span> :: <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">String</span> <span class="operator">-></span> <span class="classname">Maybe</span> <span class="classname">Directory</span> <span class="operator">-></span> <span class="classname">IO</span> ()
<span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>) <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span>
    <span class="identifier">input</span> <span class="operator"><-</span> <span class="identifier">getLine</span> 
    <span class="keyword">let</span> <span class="identifier">inputs</span> <span class="operator">=</span> <span class="identifier">splitInput</span> <span class="identifier">input</span>
    <span class="keyword">case</span> <span class="identifier">head</span> <span class="identifier">inputs</span> <span class="keyword">of</span>
        <span class="string">"cat"</span> <span class="operator">-></span> <span class="identifier">cat</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>) <span class="identifier">path</span> <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span> <span class="string">""</span> 
        <span class="string">"pwd"</span> <span class="operator">-></span> <span class="identifier">putStrLn</span> <span class="identifier">path</span>
        <span class="string">"rm"</span> <span class="operator">-></span> <span class="identifier">rmMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>)
        <span class="string">"mkdir"</span> <span class="operator">-></span> <span class="identifier">mkdirMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>)
        <span class="string">"touch"</span> <span class="operator">-></span> <span class="identifier">touchMainHelper</span> <span class="identifier">inputs</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>)
        <span class="string">"ls"</span> <span class="operator">-></span> <span class="identifier">ls</span> <span class="identifier">currDirectory</span><span class="operator">-</span><span class="operator">-</span> <span class="identifier">same</span> 
        <span class="string">"cd"</span> <span class="operator">-></span> <span class="keyword">if</span> (<span class="identifier">cd</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>)) <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span>) <span class="operator">=</span><span class="operator">=</span> <span class="classname">Nothing</span> <span class="keyword">then</span>
                    (<span class="identifier">putStrLn</span> <span class="string">"Couldn't find this directory"</span>)
                <span class="keyword">else</span> 
                    <span class="keyword">let</span> <span class="identifier">newPath</span> <span class="operator">=</span> (<span class="identifier">buildPath</span> <span class="identifier">path</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>))) <span class="keyword">in</span> 
                     (<span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">newPath</span> (<span class="identifier">cd</span> (<span class="identifier">head</span> (<span class="identifier">tail</span> <span class="identifier">inputs</span>)) <span class="identifier">mainDirectory</span> <span class="identifier">currDirectory</span>))
        <span class="identifier">_</span> <span class="operator">-></span> <span class="identifier">putStrLn</span> <span class="string">"Invalid operation!"</span>
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="identifier">path</span> (<span class="classname">Just</span> <span class="identifier">currDirectory</span>)</span>

<span class="identifier">main</span> :: <span class="classname">IO</span> ()
<span class="identifier">main</span> <span class="operator">=</span> <button class="toggle-hide" onclick="toggle(this)">+</button><span class="hidable"><span class="keyword">do</span> 
    <span class="keyword">let</span> <span class="identifier">mainDirectory</span> <span class="operator">=</span> <span class="classname">Directory</span> <span class="string">"/"</span> [] []
    <span class="identifier">directoryRecursion</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>) <span class="string">"/"</span> (<span class="classname">Just</span> <span class="identifier">mainDirectory</span>)
    <span class="identifier">putStrLn</span> (<span class="identifier">show</span> <span class="identifier">mainDirectory</span>)
    <span class="identifier">putStrLn</span> <span class="string">"ended"</span>
    <span class="identifier">return</span> ()</span>
    
</pre></body></html>
